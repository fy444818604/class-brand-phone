<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>发通知</title>
	<link href="../../css/mui.css" rel="stylesheet" />
	<link rel="stylesheet" href="//at.alicdn.com/t/font_1065627_xs9ose09vdn.css">
	<link href="../../css/public.css" rel="stylesheet" />
    <style type="text/css">
    	.mui-bar-nav~.mui-content {
		    padding-top: 57px;
		}
    	.mui-content{
    		padding-top: 0.87rem;
    	}
    	.mui-content>.mui-table-view:first-child {
		    margin-top: 0px;
		}
		.mui-table-view:after,.mui-table-view:before {
		    background: none;
		}
		.mui-table-view-cell {
		    padding: 15px 15px;
		}
		.mui-table-view-cell>a:not(.mui-btn) {
		    margin: -15px -15px;
		}
		.theClass-left{
			width: 4.6rem;
			/*color: #303133;
			font-size: ;*/
		}
		.theClass-rnt{
			width: 70%;
			color: #c0c4cc;
		}
		.theClass-rnt a{
			color: #c0c4cc;
			display: block;	
		}
		.mui-popover.mui-popover-action .mui-table-view {
		     color: #303133;
		}
		/*正文/标题*/
		.theInput{
			margin-top: 0.87rem;
			height: calc(100vh - 14.55rem);
		}
		input[type=text]{
		  border: none;
		  margin-bottom: 0px;
		   height: 20px;
	       padding: 0px 0px;
	       font-size: 1rem;
		}
		input::-webkit-input-placeholder {
	        /* placeholder颜色  */
	        color: #c0c4cc;
	         font-size: 1rem;
	        
	    }
	    textarea{
	    	-webkit-user-select: auto;
	    	border: none;
	    	font-size: 1rem;
	  		padding: 10px 0px;
	    }
	    /*发送通知*/
		.add{
			height: 3.07rem;
			background: #3B8BFF;
			color: #FFFFFF;
			font-size: 1.07rem;
			line-height: 3.07rem;
			text-align: center;
		}
	
    </style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		<h1 class="mui-title">发布通知</h1>
	</header>
	<div class="mui-content add-notice"> 
		<!--班级/对象-->
		<ul class="mui-table-view">
		    <li class="mui-table-view-cell flex">
		    	<div class="theClass-left">
		    		级别
		    	</div>
				<div class="theClass-rnt"><a href="#picture" id="level">请选择级别</a></div>
		    	<div><a class="mui-navigate-right"></a></div>
		        
		    </li>
		   <li class="mui-table-view-cell flex objetAdd">
		    	<div class="theClass-left">
		    		对象
		    	</div>
				<div class="theClass-rnt jonsData">请选择对象</div>
		    	<div><a class="mui-navigate-right"></a></div>
		    </li>
		</ul>
		<!--标题/正文-->
		<ul class="mui-table-view theInput">
		    <li class="mui-table-view-cell flex">
		    	<div class="theClass-left">标题</div>
		    	<div>
		    		<input id="title" class="mui-input-clear" type="text" placeholder="请输入帐号">
		    	</div>
		    </li>
		    <li class="mui-table-view-cell" style="background: #FFFFFF;">
		    	<div class="theClass-left">正文</div>
		    	<div>
		    		<textarea id="content" rows="10" cols="30" contenteditable="true" placeholder="请输入正文内容"></textarea>
		    	</div>
		    </li>
		</ul>
		<div class="add">
			发布
		</div>
	</div>
	
	<!--级别弹出层-->
	<div id="picture" class="mui-popover mui-popover-action ">
	    <ul class="mui-table-view top"> 
	        <li class="mui-table-view-cell">
	            <a href="#" data-type="2">班级发布</a>
	        </li>
	        <li class="mui-table-view-cell">
	            <a href="#" data-type="1">校级发布</a>
	        </li>
	    </ul>
	     <ul class="mui-table-view">
	        <li class="mui-table-view-cell">
	            <a href="#picture" style="color: #3b8bff;"><b>取消</b></a>
	        </li>
	    </ul>
	</div>
	<script src="../../js/mui.js"></script>
    <script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	
	<script type="text/javascript" charset="utf-8">
      	mui.init();
		var level = 2;
		var boardIds = "e3e36ac0ef5f446cb2a97e2f15631822";
		var insert = function() {
			var _this = this;
			var title = $('#title').val();
			var content = $('#content').val();
			mui.ajax('http://192.168.38.175:8080/phone/insertnotice.do', {
				data: {
					token: window.localStorage.getItem('token'),
					boardIds: boardIds,
					title: title,
					content: content,
					level: level
				},
				dataType: 'json', //服务器返回json格式数据
				type: 'post', //HTTP请求类型
				timeout: 10000, //超时时间设置为10秒；
				success: function(data) {
					if(data.code==200){
						mui.openWindow({
							id: 'index',
							url: './index.html'
						});
					}else{
						mui.alert(data.msg)
					}
				},
				error: function(xhr, type, errorThrown) {
	
				}
			});
		}
		mui.ready(function() {
			//弹框取值赋值
			mui('#picture').on('tap', '.top>li>a', function() {
				$('#level').text(this.dataset.type == 1?"校":"班").css('color','#3b8bff'),
				level = this.dataset.type;
				$('#picture>ul>li>a').css('color','#303133')
				$(this).css('color','#3b8bff');
				mui("#picture").popover('toggle');
			})
			
			document.querySelector('.add').addEventListener('tap',function(){
				console.log(123);
				insert();
			})
		})
    </script>
</body>
</html>